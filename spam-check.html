<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8">
  <title>ğŸ” Kavalkaran Link scanner | English </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  
  <meta name="google" content="notranslate">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam&display=swap" rel="stylesheet">
  <style>
    body {
      background:#0f172a;
      color:#f1f5f9;
      font-family:'Noto Sans Malayalam', 'Segoe UI', sans-serif;
      padding:20px;
      text-align:center;
    }
    h1 { color:#00ffae; font-size:2rem; }
    input, button {
      padding:12px;
      margin:10px;
      font-size:1rem;
      border:none;
      border-radius:8px;
      width:80%;
      max-width:500px;
    }
    input { background:#334155; color:#f8fafc; }
    button {
      background:#00ffae;
      color:#0f172a;
      cursor:pointer;
    }
    #report {
      text-align:left;
      background:#1e293b;
      padding:20px;
      border-radius:10px;
      margin-top:20px;
    }
    .safe { color:#00ff7f; }
    .danger { color:#ff4f4f; }
    .warn { color:#ffdf00; }
    img { max-width:100%; border-radius:6px; margin-top:10px; }
    pre { white-space:pre-wrap; word-wrap:break-word; }
  </style>
</head>
<body>
<div id="google_translate_container"
     style="
       position: fixed;
       top: 14px;
       right: 14px;
       z-index: 9999;
       background: #1e293b;
       padding: 6px 10px;
       border-radius: 10px;
       box-shadow: 0 4px 12px rgba(0,0,0,.35);
     ">
  <div id="google_translate_element"></div>
</div>


  <h1>ğŸŒ Kavalkaran Link scanner</h1>
  <p>Enter link Here : </p>
  <input id="urlInput" placeholder="Example: https://bit.ly/xyz">
  <button onclick="checkURL()">Verify</button>
  <div id="report"></div>

  <script>
    async function checkURL() {
      const url = document.getElementById('urlInput').value.trim();
      const output = document.getElementById('report');
      output.innerHTML = "";

      if (!url.startsWith("http")) {
        output.innerHTML = "<p class='warn'>âš ï¸ PLease give full link with http.</p>";
        return;
      }

      const domain = (new URL(url)).hostname;
      let result = [];

      output.innerHTML += `<p>ğŸŒ URL: <code>${url}</code></p>`;

      // âœ… Real SSL Check using HEAD request to https://domain
      output.innerHTML += `<p>ğŸ”’ SSL Support: <span id="sslStatus">Checking...</span></p>`;
      try {
        const testSSL = await fetch("https://" + domain, { method: "HEAD" });
        if (testSSL.ok) {
          document.getElementById("sslStatus").innerHTML = '<span class="safe">Yes</span>';
        } else {
          document.getElementById("sslStatus").innerHTML = '<span class="warn">Server not responding</span>';
        }
      } catch {
        document.getElementById("sslStatus").innerHTML = '<span class="danger">No</span>';
      }

      // WHOIS
      output.innerHTML += `<p>ğŸŒ WHOIS Checking...</p>`;
      try {
        const res = await fetch(`https://api.whois.vu/?q=${domain}`);
        const text = await res.text();
        output.innerHTML += `<p>WHOIS Results: ${text.includes("Domain Name") ? '<span class="safe">Finded</span>' : '<span class="warn">Unable to find</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">âš ï¸ Unable to get WHOIS</p>`;
      }

      // Header Status
      output.innerHTML += `<p>ğŸ”Œ Checking Header...</p>`;
      try {
        const headRes = await fetch(url, { method: 'HEAD' });
        output.innerHTML += `<p>Header: <span class="safe">âœ… ${headRes.status} ${headRes.statusText}</span></p>`;
      } catch (e) {
        output.innerHTML += `<p class="danger">âŒ Header Not get: ${e.message}</p>`;
      }

      // Screenshot Preview
      output.innerHTML += `<p>ğŸ“· à´¸àµˆà´±àµà´±à´¿à´¨àµà´±àµ† à´°àµ‚à´ªà´‚:</p><img src="https://image.thum.io/get/width/600/crop/600/${url}" alt="preview" />`;

      // AI Analysis (Offline Heuristic)
      output.innerHTML += `<p>ğŸ§  AI Analyse:</p><pre id="aiResult">Analyse going on...</pre>`;
      setTimeout(() => {
        const hints = [];
        if (url.includes("bit.ly") || url.includes("tinyurl")) hints.push("âš ï¸ Shortened URL");
        if (url.includes("login") || url.includes("signin")) hints.push("âš ï¸ Login keyword â€“ Maybe Phising");
        if (url.endsWith(".exe") || url.endsWith(".apk")) hints.push("ğŸš« Harm full File possiblity");
        if (hints.length === 0) hints.push("âœ… Restricted Hints are not present.");
        document.getElementById("aiResult").innerText = hints.join("\n");
      }, 600);

      // PhishTank Check
      output.innerHTML += `<p>ğŸ£Checking Phising...</p>`;
      try {
        const res = await fetch(`https://checkurl.phishtank.com/checkurl/?url=${encodeURIComponent(url)}&format=json`);
        const data = await res.json();
        const isPhishing = data.results.valid && data.results.in_database;
        output.innerHTML += `<p>PhishTank: ${isPhishing ? '<span class="danger">Phising possibility</span>' : '<span class="safe">Safe</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">âš ï¸ Phising data not found.</p>`;
      }

      // Spamhaus DBL Check
      output.innerHTML += `<p>ğŸš« Checking on  Spamhaus DBL</p>`;
      try {
        const spamRes = await fetch(`https://dns.google/resolve?name=${domain}.dbl.spamhaus.org&type=A`);
        const spamData = await spamRes.json();
        const listed = spamData.Answer !== undefined;
        output.innerHTML += `<p>Spamhaus: ${listed ? '<span class="danger">Present in Spamhaus DBL</span>' : '<span class="safe">Not present in Spamhaus DBL</span>'}</p>`;
      } catch {
        output.innerHTML += `<p class="warn">âš ï¸ Unable to connect with Spamhaus DBl</p>`;
      }

      // Unshortener
      output.innerHTML += `<p>ğŸ”— Unshorting Link..</p>`;
      try {
        const res = await fetch(url, { method: "GET", redirect: "follow" });
        output.innerHTML += `<p>Real Url: <code>${res.url}</code></p>`;
      } catch {
        output.innerHTML += `<p class="warn">âš ï¸ Can't Unshort URL.</p>`;
      }

      // Final Verdict
      const score = [
        !url.startsWith("https"),
        url.includes("bit.ly"),
        url.includes("login"),
        url.endsWith(".exe") || url.endsWith(".apk")
      ].filter(Boolean).length;

      if (score >= 2) {
        output.innerHTML += `<p class="danger">ğŸ”´ This Link Contains Harm - Dont Enter!</p>`;
      } else if (score === 1) {
        output.innerHTML += `<p class="warn">ğŸŸ¡ We have some doubts â€“ Be Caution.</p>`;
      } else {
        output.innerHTML += `<p class="safe">ğŸŸ¢ Url looks safe.</p>`;
      }
    }
  </script>
    <script>
  // Prefill URL input if query parameter exists
function getQueryParam(name) {
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}

const prefillUrl = getQueryParam('url');
if (prefillUrl) {
  const urlInput = document.getElementById('urlInput');
  urlInput.value = decodeURIComponent(prefillUrl);
  // Optionally auto-run the check
  document.getElementById('checkBtn').click();
}

</script>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement(
    {
      pageLanguage: 'ml',
      includedLanguages: 'en,hi,as,bn,brx,doi,gu,kn,ks,gom,mai,ml,mni,mr,ne,or,pa,sa,sat,sd,ta,te,ur',
      autoDisplay: false,
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    'google_translate_element'
  );

  applyLangFromURL();
}

/* ğŸ“Œ Read ?lang=hi */
function applyLangFromURL() {
  const params = new URLSearchParams(window.location.search);
  const lang = params.get('lang');

  if (!lang) return;

  setTimeout(() => {
    const select = document.querySelector('.goog-te-combo');
    if (select) {
      select.value = lang;
      select.dispatchEvent(new Event('change'));
    }
  }, 1200);
}
</script>

<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
